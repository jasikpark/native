var ue=Object.defineProperty;var Ve=i=>ue(i,"__esModule",{value:!0});var xe=(i,e)=>{for(var t in e)ue(i,t,{get:e[t],enumerable:!0})};Ve(exports);xe(exports,{Animate:()=>q,CSSArrValue:()=>L,CSSPropertiesToArr:()=>le,CSSValue:()=>N,DefaultAnimationOptions:()=>ae,EASINGS:()=>re,EFFECTS:()=>Oe,EasingKeys:()=>Se,GetEase:()=>ne,KeyframeParse:()=>ee,ParseTransformableCSSKeyframes:()=>de,ParseTransformableCSSProperties:()=>Te,TransformFunctionNames:()=>se,UnitDEG:()=>U,UnitDEGCSSValue:()=>c,UnitLess:()=>Y,UnitLessCSSValue:()=>d,UnitPX:()=>G,UnitPXCSSValue:()=>S,addCSSUnit:()=>_,animate:()=>Ce,computeOption:()=>te,createTransformProperty:()=>oe,default:()=>Ke,flatten:()=>be,getElements:()=>fe,getTargets:()=>F,isValid:()=>K,mapAnimationOptions:()=>ie,parseOffset:()=>X,parseOptions:()=>he,toArr:()=>$,transpose:()=>ge});var b=class{constructor(e){this.map=new Map(e)}getMap(){return this.map}get(e){return this.map.get(e)}keys(){return Array.from(this.map.keys())}values(){return Array.from(this.map.values())}set(e,t){return this.map.set(e,t),this}add(e){let r=this.size;return this.set(r,e),this}get size(){return this.map.size}get length(){return this.map.size}last(e=1){let t=this.keys()[this.size-e];return this.get(t)}delete(e){return this.map.delete(e)}remove(e){return this.map.delete(e),this}clear(){return this.map.clear(),this}has(e){return this.map.has(e)}entries(){return this.map.entries()}forEach(e,t){return this.map.forEach(e,t),this}[Symbol.iterator](){return this.entries()}},me=(i,e,...t)=>{i.forEach(r=>{r[e](...t)})};var ce=({callback:i=()=>{},scope:e=null,name:t="event"})=>({callback:i,scope:e,name:t}),v=class extends b{constructor(e="event"){super();this.name=e}},W=class extends b{constructor(){super()}getEvent(e){let t=this.get(e);return t instanceof v?t:(this.set(e,new v(e)),this.get(e))}newListener(e,t,r){let n=this.getEvent(e);return n.add(ce({name:e,callback:t,scope:r})),n}on(e,t,r){if(typeof e=="undefined")return this;typeof e=="string"&&(e=e.trim().split(/\s/g));let n,a,s=typeof e=="object"&&!Array.isArray(e),o=s?t:r;return s||(a=t),Object.keys(e).forEach(l=>{n=s?l:e[l],s&&(a=e[l]),this.newListener(n,a,o)},this),this}removeListener(e,t,r){let n=this.get(e);if(n instanceof v&&t){let a=ce({name:e,callback:t,scope:r});n.forEach((s,o)=>{if(s.callback===a.callback&&s.scope===a.scope)return n.remove(o)})}return n}off(e,t,r){if(typeof e=="undefined")return this;typeof e=="string"&&(e=e.trim().split(/\s/g));let n,a,s=typeof e=="object"&&!Array.isArray(e),o=s?t:r;return s||(a=t),Object.keys(e).forEach(l=>{n=s?l:e[l],s&&(a=e[l]),typeof a=="function"?this.removeListener(n,a,o):this.remove(n)},this),this}once(e,t,r){if(typeof e=="undefined")return this;typeof e=="string"&&(e=e.trim().split(/\s/g));let n=typeof e=="object"&&!Array.isArray(e);return Object.keys(e).forEach(a=>{let s=n?a:e[a],o=n?e[a]:t,l=n?t:r,u=(...m)=>{o.apply(l,m),this.removeListener(s,u,l)};this.newListener(s,u,l)},this),this}emit(e,...t){return typeof e=="undefined"?this:(typeof e=="string"&&(e=e.trim().split(/\s/g)),e.forEach(r=>{let n=this.get(r);n instanceof v&&n.forEach(a=>{let{callback:s,scope:o}=a;s.apply(o,t)})},this),this)}clear(){return me(this,"clear"),super.clear(),this}};var X=i=>typeof i=="string"?i.includes("%")?parseFloat(i)/100:i=="from"?0:i=="to"?1:parseFloat(i):i,ee=i=>{let e=new Set,t=Object.keys(i),r=t.length;for(let n=0;n<r;n++){let a=""+t[n],s=i[a],o=a.split(","),l=o.length;for(let u=0;u<l;u++){let m=X(o[u]);e.add({...s,offset:m})}}return[...e].sort((n,a)=>n.offset-a.offset)},Oe={};var fe=i=>typeof i=="string"?Array.from(document.querySelectorAll(i)):[i],be=i=>[].concat(...i),F=i=>Array.isArray(i)?be(i.map(F)):typeof i=="string"||i instanceof Node?fe(i):i instanceof NodeList||i instanceof HTMLCollection?Array.from(i):[],te=(i,e,t)=>typeof i=="function"?i.apply(t,e):i,ie=(i,e,t)=>{let r,n,a={},s=Object.keys(i);for(let o=0,l=s.length;o<l;o++)r=s[o],n=i[r],a[r]=te(n,e,t);return a},re={in:"ease-in",out:"ease-out","in-out":"ease-in-out","in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","in-out-expo":"cubic-bezier(1, 0, 0, 1)","in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},Se=Object.keys(re),ne=i=>{let e=i.replace(/^ease-/,"");return Se.includes(e)?re[e]:i},ae={keyframes:[],offset:[],loop:1,delay:0,speed:1,endDelay:0,easing:"ease",timelineOffset:0,autoplay:!0,duration:1e3,fillMode:"none",direction:"normal",padEndDelay:!1,extend:{}},he=i=>{let{options:e,...t}=i,r=e instanceof q?e.getOptions():Array.isArray(e)?e?.[0]?.getOptions():e;return Object.assign({},r,t)},_=(i="")=>e=>typeof e=="string"?e:`${e}${i}`,Y=_(),G=_("px"),U=_("deg"),$=i=>Array.isArray(i)||typeof i=="string"?(typeof i=="string"&&(i=i.split(",")),i):[i],K=i=>Array.isArray(i)||typeof i=="string"?Boolean(i.length):i!=null&&i!=null,N=i=>e=>K(e)?$(e).map(t=>{if(typeof t!="number"&&typeof t!="string")return t;let r=Number(t),n=Number.isNaN(r)?typeof t=="string"?t.trim():t:r;return i(n)}):[],ge=(...i)=>{let e=0;i=i.map(n=>{let a=$(n),s=a.length;return s>e&&(e=s),a});let t=[],r=i.length;for(let n=0;n<e;n++){t[n]=[];for(let a=0;a<r;a++){let s=i[a][n];K(s)&&(t[n][a]=s)}}return t},L=(i,e)=>$(i).map(N(e)),se=["translate","translate3d","translateX","translateY","translateZ","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],oe=i=>{let e="",t=se.length;for(let r=0;r<t;r++){let n=se[r],a=i[r];K(a)&&(e+=`${n}(${Array.isArray(a)?a.join(", "):a}) `)}return e.trim()},d=N(Y),S=N(G),c=N(U),le=i=>{for(let[e,t]of Object.entries(i))i[e]=[].concat(t).map(r=>""+r);return i},Te=i=>{let{perspective:e,rotate:t,rotate3d:r,rotateX:n,rotateY:a,rotateZ:s,translate:o,translate3d:l,translateX:u,translateY:m,translateZ:h,scale:g,scale3d:C,scaleX:A,scaleY:k,scaleZ:P,skew:E,skewX:V,skewY:T,...x}=i;o=L(o,G),l=L(l,G),u=S(u),m=S(m),h=S(h),t=L(t,U),r=L(r,Y),n=c(n),a=c(a),s=c(s),g=L(g,Y),C=L(C,Y),A=d(A),k=d(k),P=d(P),E=L(E,U),V=c(V),T=c(T),e=S(e);let I=ge(o,l,u,m,h,t,r,n,a,s,g,C,A,k,P,E,V,T,e).map(oe);return x=le(x),Object.assign({},K(I)?{transform:I}:null,x)},de=i=>i.map(e=>{let{translate:t,translate3d:r,translateX:n,translateY:a,translateZ:s,rotate:o,rotate3d:l,rotateX:u,rotateY:m,rotateZ:h,scale:g,scale3d:C,scaleX:A,scaleY:k,scaleZ:P,skew:E,skewX:V,skewY:T,perspective:x,...I}=e;return t=S(t),r=S(r),n=S(n)[0],a=S(a)[0],s=S(s)[0],o=c(o),l=d(l),u=c(u)[0],m=c(m)[0],h=c(h)[0],g=d(g),C=d(C),A=d(A)[0],k=d(k)[0],P=d(P)[0],E=c(E),V=c(V)[0],T=c(T)[0],x=S(x)[0],[I,t,r,n,a,s,o,l,u,m,h,g,C,A,k,P,E,V,T,x]}).map(([e,...t])=>{let r=oe(t);return e=le(e),Object.assign({},K(r)?{transform:r}:null,e)}),q=class{constructor(e){this.options={};this.targets=new b;this.properties={};this.animations=new b;this.keyframeEffects=new b;this.totalDuration=0;this.minDelay=0;this.maxSpeed=0;this.computedOptions=new b;this.computedKeyframes=new b;this.emitter=new W;this.loop=this.loop.bind(this),this.updateOptions(e)}newPromise(){return this.promise=new Promise((e,t)=>{this?.emitter?.once?.("finish",()=>e([this])),this?.emitter?.once?.("error",r=>t(r))}),this.promise}then(e,t){return e=e?.bind(this),t=t?.bind(this),this?.promise?.then?.(e,t),this}catch(e){return e=e?.bind(this),this.promise?.catch?.(e),this}finally(e){return e=e?.bind(this),this.promise?.finally?.(e),this}loop(){this.stopLoop(),this.emit("update",this.getProgress(),this),this.animationFrame=window.requestAnimationFrame(this.loop)}stopLoop(){window.cancelAnimationFrame(this.animationFrame)}allAnimations(e){return this.animations.forEach(e),this}all(e){return this.mainAnimation&&e(this.mainAnimation,this.mainElement),this.allAnimations(e),this}beginEvent(){this.getProgress()==0&&this.emit("begin",this)}play(){let e=this.getPlayState();return this.beginEvent(),this.all(t=>t.play()),this.emit("play",e,this),this.is(e)||this.emit("playstate-change",e,this),this.loop(),this}pause(){let e=this.getPlayState();return this.all(t=>t.pause()),this.emit("pause",e,this),this.is(e)||this.emit("playstate-change",e,this),this.stopLoop(),this.animationFrame=void 0,this}reverse(){return this.all(e=>e.reverse()),this}reset(){return this.setProgress(0),this.options.autoplay?this.play():this.pause(),this}cancel(){return this.all(e=>e.cancel()),this}finish(){return this.all(e=>e.finish()),this}stop(){this.cancel(),this.computedOptions.clear(),this.animations.clear(),this.keyframeEffects.clear(),this.targets.clear(),this.mainkeyframeEffect=void 0,this.mainAnimation=void 0,this.mainElement=void 0,this.emit("stop"),this.emitter.clear(),this.promise=void 0,this.computedOptions=void 0,this.animations=void 0,this.keyframeEffects=void 0,this.emitter=void 0,this.targets=void 0,this.options=void 0}getTargets(){return this.targets.values()}getAnimation(e){return this.animations.get(e)}getKeyframeEffect(e){return this.keyframeEffects.get(e)}getTiming(e){let t=e instanceof Animation?e:this.getAnimation(e),r=this.computedOptions.get(t)??{},n=this.getKeyframeEffect(t).getTiming?.()??{},a=this.getOptions();return{...ae,...a,...n,...r}}getTotalDuration(){return this.totalDuration}getCurrentTime(){return this.mainAnimation.currentTime}getProgress(){return this.getCurrentTime()/this.totalDuration*100}getSpeed(){return this.mainAnimation.playbackRate}getPlayState(){return this.mainAnimation.playState}getOptions(){return this.options}getComputedOption(e){let t=e instanceof Animation?e:this.getAnimation(e);return this.computedOptions.get(t)}is(e){return this.getPlayState()==e}setCurrentTime(e){return this.all(t=>{t.currentTime=e}),this.emit("update",this.getProgress()),this}setProgress(e){let t=e/100*this.totalDuration;return this.setCurrentTime(t),this}setSpeed(e=1){return this.maxSpeed=e,this.all(t=>{t.updatePlaybackRate?t.updatePlaybackRate(e):t.playbackRate=e}),this}updateOptions(e={}){try{this.options=Object.assign({},ae,this.options,he(e));let{loop:t,delay:r,speed:n,easing:a,timelineOffset:s,endDelay:o,duration:l,direction:u,fillMode:m,onfinish:h,oncancel:g,keyframes:C,autoplay:A,target:k,targets:P,padEndDelay:E,extend:V,...T}=this.options,x=new Set([...this.getTargets(),...F(P),...F(k)]);this.targets=new b,this.properties=T,x.forEach(p=>this.targets.add(p));let I=[],pe=[],j=this.targets.size,ye=[],Ae=this.totalDuration,ke={easing:typeof a=="string"?ne(a):a,iterations:t===!0?Infinity:t,direction:u,endDelay:o,duration:l,speed:n,delay:r,timelineOffset:s,fill:m,...V};if(this.targets.forEach((p,O)=>{let B=ie(ke,[O,j,p],this),{timelineOffset:R,...y}=B;y.delay+=R,y.tempDurations=+y.delay+ +y.duration*+y.iterations+ +y.endDelay,this.totalDuration<+y.tempDurations&&(this.totalDuration=+y.tempDurations),ye[O]=y,I.push(y.delay),pe.push(y.speed)}),this.targets.forEach((p,O)=>{let{speed:B,tempDurations:R,...y}=ye[O],H,w;E&&y.endDelay==0&&Math.abs(+y.iterations)!=Math.abs(Infinity)&&(y.endDelay=this.totalDuration-R);let z=te(C,[O,j,p],this);if(typeof z=="object"&&(z=ee(z)),H=K(z)?z:T,Array.isArray(H))w=H.map(J=>{let{speed:Z,loop:D,easing:Q,offset:Pe,...Ee}=J;return{easing:typeof Q=="string"?ne(Q):Q,iterations:D===!0?Infinity:D,offset:X(Pe),...Ee}}),w=de(w);else{let{offset:J,...Z}=ie(H,[O,j,p],this),D=J;Z=Te(Z),w=Object.assign({},K(D)?{offset:D.map(X)}:null,Z)}let f,M;this.animations.has(p)?(f=this.getAnimation(p),M=this.getKeyframeEffect(f),M?.setKeyframes?.(w),M?.updateTiming?.(y)):(M=new KeyframeEffect(p,w,y),f=new Animation(M,y.timeline),this.animations.set(p,f),this.keyframeEffects.set(f,M)),f.playbackRate=B,f.onfinish=()=>{typeof h=="function"&&h.call(this,p,O,j,f)},f.oncancel=()=>{typeof g=="function"&&g.call(this,p,O,j,f)},this.computedOptions.set(f,y),this.computedKeyframes.set(f,w)}),this.mainAnimation?Ae!==this.totalDuration&&(this.mainkeyframeEffect?.updateTiming?.({duration:this.totalDuration}),(!this.mainkeyframeEffect.setKeyframes||!this.mainkeyframeEffect.updateTiming)&&console.error("@okikio/animate - `KeyframeEffect.setKeyframes` and/or `KeyframeEffect.updateTiming` are not supported in this browser.")):(this.mainkeyframeEffect=new KeyframeEffect(this.mainElement,[{opacity:"0"},{opacity:"1"}],{duration:this.totalDuration,easing:"linear"}),this.mainAnimation=new Animation(this.mainkeyframeEffect,this.options.timeline),this.mainAnimation.onfinish=()=>{let p=this.getPlayState();this.emit("finish",p,this),this.is(p)||this.emit("playstate-change",p,this),this.stopLoop()},this.mainAnimation.oncancel=()=>{let p=this.getPlayState();this.emit("cancel",p,this),this.is(p)||this.emit("playstate-change",p,this),this.stopLoop()}),this.minDelay=Math.min(...I),this.maxSpeed=Math.min(...pe),this.mainAnimation.playbackRate=this.maxSpeed,A){let p=window.setTimeout(()=>{this.emit("begin",this),p=window.clearTimeout(p)},0);this.play()}else this.pause();this.newPromise()}catch(t){this.emit("error",t)}}on(e,t,r){return this?.emitter?.on(e,t,r??this),this}off(e,t,r){return this?.emitter?.off(e,t,r??this),this}emit(e,...t){return this?.emitter?.emit(e,...t),this}toJSON(){return this.getOptions()}get[Symbol.toStringTag](){return"Animate"}},Ce=(i={})=>new q(i),Ke=Ce;0&&(module.exports={Animate,CSSArrValue,CSSPropertiesToArr,CSSValue,DefaultAnimationOptions,EASINGS,EFFECTS,EasingKeys,GetEase,KeyframeParse,ParseTransformableCSSKeyframes,ParseTransformableCSSProperties,TransformFunctionNames,UnitDEG,UnitDEGCSSValue,UnitLess,UnitLessCSSValue,UnitPX,UnitPXCSSValue,addCSSUnit,animate,computeOption,createTransformProperty,flatten,getElements,getTargets,isValid,mapAnimationOptions,parseOffset,parseOptions,toArr,transpose});
