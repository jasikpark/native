!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t=t||self)["@okikio/event-emitter"]={})}(this,function(t){function i(t,i){if(null==t)return{};var e,n,r={},s=Object.keys(t);for(n=0;n<s.length;n++)i.indexOf(e=s[n])>=0||(r[e]=t[e]);return r}class e{constructor(t){this.map=new Map(t)}getMap(){return this.map}get(t){return this.map.get(t)}keys(){return[...this.map.keys()]}values(){return[...this.map.values()]}set(t,i){return this.map.set(t,i),this}add(t){return this.set(this.size,t),this}get size(){return this.map.size}last(t=1){let i=this.keys()[this.size-t];return this.get(i)}prev(){return this.last(2)}delete(t){return this.map.delete(t),this}clear(){return this.map.clear(),this}has(t){return this.map.has(t)}entries(){return this.map.entries()}forEach(t=((...t)=>{}),i){return this.map.forEach(t,i),this}[Symbol.iterator](){return this.entries()}methodCall(t,...i){return this.forEach(e=>{e[t](...i)}),this}async asyncMethodCall(t,...i){for await(let[,e]of this.map)await e[t](...i);return this}}class n{constructor({callback:t=(()=>{}),scope:i=null,name:e="event"}){this.listener={callback:t,scope:i,name:e}}getCallback(){return this.listener.callback}getScope(){return this.listener.scope}getEventName(){return this.listener.name}toJSON(){return this.listener}}class r extends e{constructor(t="event"){super(),this.name=t}}class s extends e{constructor(){super()}getEvent(t){let i=this.get(t);return i instanceof r?i:(this.set(t,new r(t)),this.get(t))}newListener(t,i,e){let r=this.getEvent(t);return r.add(new n({name:t,callback:i,scope:e})),r}on(t,i,e){if(void 0===t)return this;let n,r,s;return"string"==typeof t&&(t=t.split(/\s/g)),Object.keys(t).forEach(a=>{"object"!=typeof t||Array.isArray(t)?(n=t[a],r=i,s=e):(n=a,r=t[a],s=i),this.newListener(n,r,s)},this),this}removeListener(t,i,e){let r=this.getEvent(t);if(i){let s,a=0,o=r.size,u=new n({name:t,callback:i,scope:e});for(;a<o&&(s=r.get(a),console.log(s),s.getCallback()!==u.getCallback()||s.getScope()!==u.getScope());a++);r.delete(a)}return r}off(t,i,e){if(void 0===t)return this;let n,r,s;return"string"==typeof t&&(t=t.split(/\s/g)),Object.keys(t).forEach(a=>{"object"!=typeof t||Array.isArray(t)?(n=t[a],r=i,s=e):(n=a,r=t[a],s=i),r?this.removeListener(n,r,s):this.delete(n)},this),this}once(t,i,e){if(void 0===t)return this;"string"==typeof t&&(t=t.split(/\s/g));let n=(...r)=>{this.off(t,n,e),i.apply(e,r)};return this.on(t,n,e),this}emit(t,...i){return void 0===t||("string"==typeof t&&(t=t.split(/\s/g)),t.forEach(t=>{let e=this.getEvent(t);const n=new CustomEvent(t,{detail:i});window.dispatchEvent(n),e.forEach(t=>{let{callback:e,scope:n}=t.toJSON();e.apply(n,i)})},this)),this}}var a=function(t){return"string"==typeof t?Array.from(document.querySelectorAll(t)):[t]},o=function(t){return Array.isArray(t)?t:"string"==typeof t||t instanceof Node?a(t):t instanceof NodeList||t instanceof HTMLCollection?Array.from(t):[]},u=function(t,i){return"function"==typeof t?t.apply(void 0,i):t},c=function(t,i){for(var e,n={},r=Object.keys(t),s=0,a=r.length;s<a;s++)n[e=r[s]]=u(t[e],i);return n},h={ease:"ease",in:"ease-in",out:"ease-out","in-out":"ease-in-out","in-sine":"cubic-bezier(0.47, 0, 0.745, 0.715)","out-sine":"cubic-bezier(0.39, 0.575, 0.565, 1)","in-out-sine":"cubic-bezier(0.445, 0.05, 0.55, 0.95)","in-quad":"cubic-bezier(0.55, 0.085, 0.68, 0.53)","out-quad":"cubic-bezier(0.25, 0.46, 0.45, 0.94)","in-out-quad":"cubic-bezier(0.455, 0.03, 0.515, 0.955)","in-cubic":"cubic-bezier(0.55, 0.055, 0.675, 0.19)","out-cubic":"cubic-bezier(0.215, 0.61, 0.355, 1)","in-out-cubic":"cubic-bezier(0.645, 0.045, 0.355, 1)","in-quart":"cubic-bezier(0.895, 0.03, 0.685, 0.22)","out-quart":"cubic-bezier(0.165, 0.84, 0.44, 1)","in-out-quart":"cubic-bezier(0.77, 0, 0.175, 1)","in-quint":"cubic-bezier(0.755, 0.05, 0.855, 0.06)","out-quint":"cubic-bezier(0.23, 1, 0.32, 1)","in-out-quint":"cubic-bezier(0.86, 0, 0.07, 1)","in-expo":"cubic-bezier(0.95, 0.05, 0.795, 0.035)","out-expo":"cubic-bezier(0.19, 1, 0.22, 1)","in-out-expo":"cubic-bezier(1, 0, 0, 1)","in-circ":"cubic-bezier(0.6, 0.04, 0.98, 0.335)","out-circ":"cubic-bezier(0.075, 0.82, 0.165, 1)","in-out-circ":"cubic-bezier(0.785, 0.135, 0.15, 0.86)","in-back":"cubic-bezier(0.6, -0.28, 0.735, 0.045)","out-back":"cubic-bezier(0.175, 0.885, 0.32, 1.275)","in-out-back":"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},l=function(t){return/^(ease|in|out)/.test(t)?h[t]:t},m={keyframes:[],loop:1,delay:0,speed:1,endDelay:0,easing:"ease",autoplay:!0,duration:1e3,onfinish:function(){},fillMode:"auto",direction:"normal"},f=function(){function t(t){var e=this;void 0===t&&(t={}),this.options={},this.targets=[],this.properties={},this.animations=new Map,this.duration=0,this.emitter=new s;var n=t.options,r=i(t,["options"]);this.options=Object.assign({},m,n,r);var a,h=this.options,f=h.loop,p=h.delay,d=h.speed,b=h.easing,y=h.endDelay,g=h.duration,v=h.direction,z=h.fillMode,k=h.onfinish,A=h.target,w=h.keyframes,E=h.autoplay,S=i(h,["loop","delay","speed","easing","endDelay","duration","direction","fillMode","onfinish","target","keyframes","autoplay"]);this.mainElement=document.createElement("span"),this.targets=o(A),this.properties=S;for(var O=function(t,i){var n=e.targets[t],r={easing:l(b),iterations:!0===f?Infinity:f,direction:v,endDelay:y,duration:g,delay:p,fill:z},s=u(w,[t,i,n]);a=s.length?s:e.properties,r=c(r,[t,i,n]),s.length>0||(a=c(a,[t,i,n]));var o=r.delay+r.duration*r.iterations+r.endDelay;e.duration<o&&(e.duration=o);var h=n.animate(a,r);h.onfinish=function(){k(n,t,i)},e.animations.set(n,h)},q=0,C=this.targets.length;q<C;q++)O(q,C);this.mainAnimation=this.mainElement.animate([{opacity:"0"},{opacity:"1"}],{duration:this.duration,easing:"linear"}),this.setSpeed(d),E?this.play():this.pause(),this.promise=this.newPromise(),this.mainAnimation.onfinish=function(){e.finish(e.options),window.cancelAnimationFrame(e.animationFrame)}}var e=t.prototype;return e.newPromise=function(){var t=this;return new Promise(function(i,e){try{t.finish=function(e){return t.emit("finish",e),i(e)}}catch(t){e(t)}})},e.then=function(t,i){return this.promise.then(t,i)},e.catch=function(t){return this.promise.catch(t)},e.finally=function(t){return this.promise.finally(t)},e.loop=function(){this.animationFrame=window.requestAnimationFrame(this.loop.bind(this)),this.emit("tick change",this.getCurrentTime())},e.on=function(t,i,e){return this.emitter.on(t,i,e),this},e.off=function(t,i,e){return this.emitter.off(t,i,e),this},e.emit=function(t){var i;return(i=this.emitter).emit.apply(i,[t].concat([].slice.call(arguments,1))),this},e.getAnimation=function(t){return this.animations.get(t)},e.play=function(){return"finished"!==this.mainAnimation.playState&&(this.mainAnimation.play(),this.animationFrame=requestAnimationFrame(this.loop.bind(this)),this.animations.forEach(function(t){"finished"!==t.playState&&t.play()}),this.emit("play")),this},e.pause=function(){return"finished"!==this.mainAnimation.playState&&(this.mainAnimation.pause(),window.cancelAnimationFrame(this.animationFrame),this.animations.forEach(function(t){"finished"!==t.playState&&t.pause()}),this.emit("pause")),this},e.getDuration=function(){return this.duration},e.getCurrentTime=function(){return this.mainAnimation.currentTime},e.setCurrentTime=function(t){return this.mainAnimation.currentTime=t,this.animations.forEach(function(i){i.currentTime=t}),this},e.getProgress=function(){return this.getCurrentTime()/this.duration},e.setProgress=function(t){var i=this;return this.mainAnimation.currentTime=t*this.duration,this.animations.forEach(function(e){e.currentTime=t*i.duration}),this},e.getSpeed=function(){return this.mainAnimation.playbackRate},e.setSpeed=function(t){return void 0===t&&(t=1),this.mainAnimation.playbackRate=t,this.animations.forEach(function(i){i.playbackRate=t}),this},e.reset=function(){this.setCurrentTime(0),this.promise=this.newPromise(),this.options.autoplay?this.play():this.pause()},e.getPlayState=function(){return this.mainAnimation.playState},e.getOptions=function(){return this.options},e.toJSON=function(){return this.getOptions()},t}();t.Animate=f,t.DefaultAnimationOptions=m,t.animate=function(t){return void 0===t&&(t={}),new f(t)},t.computeValue=u,t.easings=h,t.getEase=l,t.getElements=a,t.getTargets=o,t.mapObject=c});
//# sourceMappingURL=api.umd.js.map
