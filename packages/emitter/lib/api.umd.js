(function(i,j){typeof exports==="object"&&typeof module!=="undefined"?j(exports):typeof define==="function"&&define.amd?define(["exports"],j):(i=i||self,j(i.EventEmitter={}))})(this,function(i){"use strict";class j{constructor(a){this.map=new Map(a)}getMap(){return this.map}get(a){return this.map.get(a)}keys(){return Array.from(this.map.keys())}values(){return Array.from(this.map.values())}set(a,b){return this.map.set(a,b),this}add(a){return this.set(this.size,a),this}get size(){return this.map.size}last(a=1){let b=this.keys()[this.size-a];return this.get(b)}prev(){return this.last(2)}delete(a){return this.map.delete(a),this}clear(){return this.map.clear(),this}has(a){return this.map.has(a)}entries(){return this.map.entries()}forEach(a=(...e)=>{},b){return this.map.forEach(a,b),this}[Symbol.iterator](){return this.entries()}methodCall(a,...b){return this.forEach(e=>{e[a](...b)}),this}async asyncMethodCall(a,...b){for(let[,e]of this.map)await e[a](...b);return this}}class l{constructor({callback:a=()=>{},scope:b=null,name:e="event"}){this.listener={callback:a,scope:b,name:e}}getCallback(){return this.listener.callback}getScope(){return this.listener.scope}getEventName(){return this.listener.name}toJSON(){return this.listener}}class k extends j{constructor(a="event"){super();this.name=a}}class m extends j{constructor(){super()}getEvent(a){let b=this.get(a);return b instanceof k?b:(this.set(a,new k(a)),this.get(a))}newListener(a,b,e){let c=this.getEvent(a);return c.add(new l({name:a,callback:b,scope:e})),c}on(a,b,e){if(typeof a=="undefined")return this;typeof a=="string"&&(a=a.split(/\s/g));let c,d,g=typeof a=="object"&&!Array.isArray(a),h=g?b:e;return g||(d=b),Object.keys(a).forEach(f=>{g?(c=f,d=a[f]):c=a[f],this.newListener(c,d,h)},this),this}removeListener(a,b,e){let c=this.get(a);if(c instanceof k&&b){let d=0,g=c.size,h,f=new l({name:a,callback:b,scope:e});for(;d<g;d++){h=c.get(d);if(h.getCallback()===f.getCallback()&&h.getScope()===f.getScope())break}c.delete(d)}return c}off(a,b,e){if(typeof a=="undefined")return this;typeof a=="string"&&(a=a.split(/\s/g));let c,d,g=typeof a=="object"&&!Array.isArray(a),h=g?b:e;return g||(d=b),Object.keys(a).forEach(f=>{g?(c=f,d=a[f]):c=a[f],d?this.removeListener(c,d,h):this.delete(c)},this),this}once(a,b,e){if(typeof a=="undefined")return this;typeof a=="string"&&(a=a.split(/\s/g));let c,d,g=typeof a==="object"&&!Array.isArray(a),h=g?b:e;return g||(d=b),Object.keys(a).forEach(f=>{g?(c=f,d=a[f]):c=a[f];let n=(...o)=>{g?(c=f,d=a[f]):c=a[f],this.off(c,n,h),d.apply(h,o)};this.on(c,n,h)},this),this}emit(a,...b){return typeof a=="undefined"?this:(typeof a=="string"&&(a=a.split(/\s/g)),a.forEach(e=>{let c=this.get(e);c instanceof k&&c.forEach(d=>{let{callback:g,scope:h}=d.toJSON();g.apply(h,b)})},this),this)}}i.Event=k,i.EventEmitter=m,i.Listener=l,i.default=m,Object.defineProperty(i,"__esModule",{value:!0})});
//# sourceMappingURL=api.umd.js.map
